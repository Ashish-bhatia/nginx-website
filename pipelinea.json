{
    "appConfig": {},
    "name": "demo",
    "application": "nginx",
    "expectedArtifacts": [
        {
            "defaultArtifact": {
                "kind": "default.gcs",
                "name": "gs://nginx-website-ashish/deployment/nginx-deployment-canary.yaml",
                "reference": "gs://nginx-website-ashish/deployment/nginx-deployment-canary.yaml",
                "type": "gcs/object"
            },
            "displayName": "gs://nginx-website-ashish/deployment/nginx-deployment-canary.yaml",
            "id": "7a9fb17e-3d93-44e6-af23-a4e1e23fdb76",
            "matchArtifact": {
                "kind": "gcs",
                "name": "gs://nginx-website-ashish/deployment/nginx-deployment-canary.yaml",
                "type": "gcs/object"
            },
            "useDefaultArtifact": true,
            "usePriorArtifact": true
        },
        {
            "defaultArtifact": {
                "kind": "default.gcs",
                "name": "gs://nginx-website-ashish/services/nginx-service-canary.yaml",
                "reference": "gs://nginx-website-ashish/services/nginx-service-canary.yaml",
                "type": "gcs/object"
            },
            "displayName": "gs://nginx-website-ashish/services/nginx-service-canary.yaml",
            "id": "cc1ee8d7-e94c-45d1-be2c-3edb9a9da7c4",
            "matchArtifact": {
                "kind": "gcs",
                "name": "gs://nginx-website-ashish/services/nginx-service-canary.yaml",
                "type": "gcs/object"
            },
            "useDefaultArtifact": true,
            "usePriorArtifact": true
        },
        {
            "defaultArtifact": {
                "kind": "default.docker",
                "name": "gcr.io/spinnaker-334105/nginx-website",
                "reference": "gcr.io/spinnaker-334105/nginx-website:v5",
                "type": "docker/image",
                "version": "v5"
            },
            "displayName": "gcr.io/spinnaker-334105/nginx-website",
            "id": "ef6e0159-8b3c-4253-bddd-ac9453efaad2",
            "matchArtifact": {
                "name": "gcr.io/spinnaker-334105/nginx-website",
                "type": "docker/image"
            },
            "useDefaultArtifact": true,
            "usePriorArtifact": true,
            "usePriorExecution": false
        },
        {
            "defaultArtifact": {
                "kind": "default.gcs",
                "name": "gs://nginx-website-ashish/services/nginx-service-prod.yaml",
                "reference": "gs://nginx-website-ashish/services/nginx-service-prod.yaml",
                "type": "gcs/object"
            },
            "displayName": "gs://nginx-website-ashish/services/nginx-service-prod.yaml",
            "id": "881ba4cc-c1ab-4fd3-ab5e-d3399064b8ab",
            "matchArtifact": {
                "kind": "gcs",
                "name": "gs://nginx-website-ashish/services/nginx-service-prod.yaml",
                "type": "gcs/object"
            },
            "useDefaultArtifact": true,
            "usePriorArtifact": true
        },
        {
            "defaultArtifact": {
                "kind": "default.gcs",
                "name": "gs://nginx-website-ashish/deployment/nginx-deployment-prod.yaml",
                "reference": "gs://nginx-website-ashish/deployment/nginx-deployment-prod.yaml",
                "type": "gcs/object"
            },
            "displayName": "gs://nginx-website-ashish/deployment/nginx-deployment-prod.yaml",
            "id": "5e8f4870-c096-4a65-b1fd-9a77defe96d2",
            "matchArtifact": {
                "kind": "gcs",
                "name": "gs://nginx-website-ashish/deployment/nginx-deployment-prod.yaml",
                "type": "gcs/object"
            },
            "useDefaultArtifact": true,
            "usePriorArtifact": true
        }
    ],
    "keepWaitingPipelines": false,
    "lastModifiedBy": "anonymous",
    "limitConcurrent": true,
    "spelEvaluator": "v4",
    "stages": [
        {
            "account": "default",
            "cloudProvider": "kubernetes",
            "manifestArtifactAccount": "gcs-spinnaker-334105",
            "manifestArtifactId": "7a9fb17e-3d93-44e6-af23-a4e1e23fdb76",
            "moniker": {
                "app": "nginx-website"
            },
            "name": "Deploy Canary",
            "refId": "1",
            "requiredArtifactIds": [
                "7a9fb17e-3d93-44e6-af23-a4e1e23fdb76",
                "cc1ee8d7-e94c-45d1-be2c-3edb9a9da7c4"
            ],
            "requiredArtifacts": [],
            "requisiteStageRefIds": [],
            "skipExpressionEvaluation": false,
            "source": "artifact",
            "trafficManagement": {
                "enabled": false,
                "options": {
                    "enableTraffic": false,
                    "services": []
                }
            },
            "type": "deployManifest"
        },
        {
            "failPipeline": true,
            "instructions": "Approve the manual judgement",
            "judgmentInputs": [],
            "name": "Manual Judgment",
            "notifications": [],
            "refId": "2",
            "requisiteStageRefIds": [
                "1"
            ],
            "type": "manualJudgment"
        },
        {
            "name": "Wait 30 min",
            "refId": "3",
            "requisiteStageRefIds": [
                "1"
            ],
            "type": "wait",
            "waitTime": 1800
        },
        {
            "account": "default",
            "cloudProvider": "kubernetes",
            "manifestArtifactAccount": "gcs-spinnaker-334105",
            "manifestArtifactId": "5e8f4870-c096-4a65-b1fd-9a77defe96d2",
            "moniker": {
                "app": "nginx-website"
            },
            "name": "Deploy prod (blue green)",
            "refId": "4",
            "requiredArtifactIds": [
                "5e8f4870-c096-4a65-b1fd-9a77defe96d2",
                "881ba4cc-c1ab-4fd3-ab5e-d3399064b8ab"
            ],
            "requiredArtifacts": [],
            "requisiteStageRefIds": [
                "3",
                "2"
            ],
            "skipExpressionEvaluation": false,
            "source": "artifact",
            "trafficManagement": {
                "enabled": false,
                "options": {
                    "enableTraffic": false,
                    "services": []
                }
            },
            "type": "deployManifest"
        },
        {
            "command": "Smoke Test",
            "failPipeline": true,
            "name": "Smoke Test",
            "refId": "5",
            "requisiteStageRefIds": [
                "4"
            ],
            "scriptPath": "./",
            "type": "script",
            "user": "[anonymous]",
            "waitForCompletion": true
        },
        {
            "account": "default",
            "app": "nginx-website",
            "cloudProvider": "kubernetes",
            "kinds": [
                "apiService",
                "deployment"
            ],
            "labelSelectors": {
                "selectors": [
                    {
                        "key": "env",
                        "kind": "EQUALS",
                        "values": [
                            "Canary"
                        ]
                    }
                ]
            },
            "location": "default",
            "mode": "label",
            "name": "Delete (Manifest)",
            "options": {
                "cascading": true
            },
            "refId": "6",
            "requisiteStageRefIds": [
                "4"
            ],
            "type": "deleteManifest"
        },
        {
            "name": "Wait 2 hour",
            "refId": "7",
            "requisiteStageRefIds": [
                "4"
            ],
            "type": "wait",
            "waitTime": 7200
        },
        {
            "command": "Promote",
            "failPipeline": true,
            "name": "Promote new version",
            "notifications": [
                {
                    "address": "inspiremeashish@gmail.com",
                    "level": "stage",
                    "message": {
                        "stage.complete": {
                            "text": ""
                        }
                    },
                    "type": "email",
                    "when": [
                        "stage.complete",
                        "stage.starting",
                        "stage.failed"
                    ]
                }
            ],
            "refId": "8",
            "requisiteStageRefIds": [
                "7",
                "6",
                "5"
            ],
            "scriptPath": "./",
            "sendNotifications": true,
            "type": "script",
            "user": "[anonymous]",
            "waitForCompletion": true
        },
        {
            "account": "default",
            "app": "nginx-website",
            "cloudProvider": "kubernetes",
            "kinds": [
                "apiService",
                "deployment"
            ],
            "labelSelectors": {
                "selectors": [
                    {
                        "key": "env",
                        "kind": "EQUALS",
                        "values": [
                            "Canary"
                        ]
                    }
                ]
            },
            "location": "default",
            "mode": "label",
            "name": "Delete (Manifest)",
            "options": {
                "cascading": true
            },
            "refId": "9",
            "requisiteStageRefIds": [
                "8"
            ],
            "type": "deleteManifest"
        }
    ],
    "triggers": [
        {
            "account": "gcr",
            "attributeConstraints": {},
            "enabled": true,
            "expectedArtifactIds": [
                "ef6e0159-8b3c-4253-bddd-ac9453efaad2"
            ],
            "payloadConstraints": {
                "tag": "gcr.io/spinnaker-334105/nginx-website:v.*"
            },
            "pubsubSystem": "google",
            "registry": "gcr.io",
            "repository": "spinnaker-334105/nginx-website",
            "subscriptionName": "gcr-triggers",
            "tag": "v.*",
            "type": "pubsub"
        }
    ],
    "updateTs": "1638669965492"
}